produccion_actual:
  type: spark.SparkDataset
  filepath: "/home/javier/proyectos/Lomar-ModernStack/"
  file_format: jdbc
  load_args:
    url: "jdbc:sqlserver://54.82.95.244:1433;databaseName=primar;encrypt=true;trustServerCertificate=true;"
    dbtable: "dbo.produccion_actual"
    driver: "com.microsoft.sqlserver.jdbc.SQLServerDriver"
    
    # --- CAMBIO AQU√ç: Usamos 'env' en lugar de 'oc.env' ---
    user: "${env:SQL_USER}"
    password: "${env:SQL_PASSWORD}" 
    # -----------------------------------------------------

produccion_procesada:
  type: spark.SparkDataset
  filepath: data/02_intermediate/produccion_procesada.parquet
  file_format: parquet
  save_args:
    mode: "overwrite"