# ====================================================
# 1. PRIMAR
# ====================================================
sql_primar_produccion:
  type: spark.SparkDataset
  filepath: "/tmp/primar"
  file_format: jdbc
  load_args:
    url: "jdbc:sqlserver://54.82.95.244:1433;databaseName=primar;encrypt=true;trustServerCertificate=true;"
    dbtable: "dbo.produccion_actual"
    driver: "com.microsoft.sqlserver.jdbc.SQLServerDriver"
    user: "${env:SQL_USER}"
    password: "${env:SQL_PASSWORD}"
    numPartitions: 8
    partitionColumn: "FechaProduccion"  
    lowerBound: "2025-01-01 00:00:00" 
    upperBound: "2026-12-31 23:59:59"
    fetchsize: "10000"


# ====================================================
# 2. PDA
# ====================================================
sql_pda_produccion:
  type: spark.SparkDataset
  filepath: "/tmp/pda" 
  file_format: jdbc
  load_args:
    url: "jdbc:sqlserver://54.82.95.244:1433;databaseName=pda;encrypt=true;trustServerCertificate=true;"
    dbtable: "dbo.produccion_actual"
    driver: "com.microsoft.sqlserver.jdbc.SQLServerDriver"
    user: "${env:SQL_USER}"
    password: "${env:SQL_PASSWORD}"
    numPartitions: 8
    partitionColumn: "FechaProduccion" 
    lowerBound: "2025-01-01 00:00:00" 
    upperBound: "2026-12-31 23:59:59"
    fetchsize: "10000"

# ====================================================
# 3. PATSAC
# ====================================================
sql_patsac_produccion:
  type: spark.SparkDataset
  filepath: "/tmp/patsac"
  file_format: jdbc
  load_args:
    url: "jdbc:sqlserver://54.82.95.244:1433;databaseName=patsac;encrypt=true;trustServerCertificate=true;"
    dbtable: "dbo.produccion_actual"
    driver: "com.microsoft.sqlserver.jdbc.SQLServerDriver"
    user: "${env:SQL_USER}"
    password: "${env:SQL_PASSWORD}"
    numPartitions: 8
    partitionColumn: "FechaProduccion" 
    lowerBound: "2025-01-01 00:00:00"  
    upperBound: "2026-12-31 23:59:59"
    fetchsize: "10000"

# ====================================================
# CAPA INTERMEDIA (Silver)
# ====================================================
int_produccion_unificada:
  type: spark.SparkDataset
  filepath: data/02_intermediate/produccion_unificada.parquet
  file_format: parquet
  save_args:
    mode: "overwrite"

# --- CAPA PRIMARY (Gold) ---
prm_produccion_enriquecida:
  type: spark.SparkDataset
  filepath: gs://lomar-data-portafolio/gold/produccion_enriquecida.parquet
  file_format: parquet
  save_args:
    mode: "overwrite"

# --- CAPA REPORTING ---
rep_dim_calendario:
  type: spark.SparkDataset
  filepath: gs://lomar-data-portafolio/gold/dim_calendario.parquet
  file_format: parquet
  save_args:
    mode: "overwrite"