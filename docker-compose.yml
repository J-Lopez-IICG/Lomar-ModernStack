services:
  kedro-spark:
    build: .
    image: lomar-kedro-img
    container_name: lomar_spark_env
    ports:
      - "8080:8080" # Airflow UI
      - "4040:4040" # Spark UI
      - "4141:4141" # Kedro Viz
    environment:
      - SPARK_MASTER=local[*]
      # Docker Compose leerá estas variables de tu sesión activa de WSL
      - SQL_USER=${SQL_USER}
      - SQL_PASSWORD=${SQL_PASSWORD}
      - GCP_KEY_PATH=${GCP_KEY_PATH}
    volumes:
      - .:/app

  airflow:
    image: apache/airflow:2.7.1-python3.10
    container_name: lomar_airflow_env
    command: standalone
    ports:
      - "8081:8080" # Usamos 8081 si el 8080 está ocupado
    volumes:
      - .:/opt/airflow